<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook V4.4//EN" [
  <!ENTITY vertigo "<command>vertigo</command>">
  <!ENTITY observer "<oointerface><interfacename>Observer</interfacename></oointerface>">
]>

<refentry>

<refentryinfo>
  <title> Vertigo </title>
  <productname>Vertigo</productname>
  <copyright>
    <year>2006</year>
  </copyright>
  <authorgroup>
      <author>
         <firstname>Wolfgang</firstname>
         <surname>Waltenberger</surname>
         <affiliation>
           <address>
             <email>walten@hephy.oeaw.ac.at</email>
           </address>
         </affiliation>
      </author>
      <author>
         <firstname>Fabian</firstname>
         <surname>Moser</surname>
         <affiliation>
           <address>
             <email>hm@hm.de</email>
           </address>
         </affiliation>
      </author>
  </authorgroup>
  <date>2006-06-29</date>
  <edition>$Rev: 261 $</edition>
</refentryinfo>

<refmeta>
  <refentrytitle>Vertigo</refentrytitle>
  <manvolnum>1</manvolnum>
</refmeta>

<refnamediv>
  <refname>&vertigo;</refname>
  <refpurpose>a command line tool to test rave algorithms in various environments</refpurpose>
</refnamediv>

<refsynopsisdiv>
  <cmdsynopsis>
      <command>vertigo</command>
      <group choice="opt">
        <arg choice="plain"><option>-h</option></arg>
        <arg choice="plain"><option>-l</option></arg>
        <arg choice="plain"><option>-v<replaceable class="option">VERBOSITY</replaceable></option></arg>
        <arg choice="plain"><option>-s<replaceable class="option">SOURCE</replaceable></option></arg>
        <arg choice="plain"><option>-m<replaceable class="option">METHOD</replaceable></option></arg>
        <arg choice="plain"><option>-S<replaceable class="option">SKIN</replaceable></option></arg>
        <arg choice="plain"><option>-n<replaceable class="option">NUM</replaceable></option></arg>
        <arg choice="plain"><option>-o<replaceable class="option">OBSERVER</replaceable></option></arg>
        <arg choice="plain"><option>-c<replaceable class="option">CONFIGURABLE</replaceable></option></arg>
        <arg choice="plain"><option>-C</option></arg>
        <!-- [-h] [-l] [-v<verbosity>] [-s<source>] [-m<method>] [-S<skin>] [-n<min-max>] [-o<observers>] [-c<name1=value1,name2=value2>] [-C] -->
      </group>
  </cmdsynopsis>
</refsynopsisdiv>

<refsect1 id="description">
    <title>DESCRIPTION</title>
    <para>
    &vertigo; is conceived as a command line tool to test rave algorithms with both artifical 
    ("vertex gun") and realistic data. It can currently  read in data generated by a
    data harvester, as well as LCIO data.
    On the analysis side, &vertigo; has a few &observer; classes that make it easy
    to analyse the performance of the vertex reconstruction algorithms.
    This man page is for $Rev: 261 $. 
    </para>
</refsect1>

<refsect1 id="options">
    <title>OPTIONS</title>
    <para>
      &vertigo; accepts the following options:
    </para>

    <variablelist>
      <varlistentry>
      <term><option>-h,--help</option></term>
      <listitem>
        <para>Shows the help page</para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-l,--list</option></term>
      <listitem>
        <para>List all methods and observers (then quit)</para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-v,--verbosity</option></term>
      <listitem>
        <para>Set verbosity [default 10]. "-v0" means complete silence.
              "-v1" plots one dot per event, and nothing else.</para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-s,--source</option></term>
      <listitem>
        <para>Specify data source [default=gun:simple]</para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-S,--skin</option></term>
      <listitem>
        <para>Specify skin [default=CMS] </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-m,--method</option></term>
      <listitem>
        <para>Specify reconstruction method [default=default] </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-n,--events</option></term>
      <listitem>
        <para>Specify the event numbers to be considered. </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-o,--observer</option></term>
      <listitem>
        <para>Run only specified observers. (comma-separated list, no white spaces) </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-c,--configurable</option></term>
      <listitem>
        <para>Set configurables. -cname=value,name2=value2,... </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><option>-c,--list-configurables</option></term>
      <listitem>
        <para>List all configurables that have been in use at the end of the run.</para>
      </listitem>
      </varlistentry>

    </variablelist>
</refsect1>

<refsect1 id="datasources">
    <title>DATA SOURCES</title>
    <para>Depending on the configuration at compile time,
    the user can use certain sub-set of the following data sources:
    </para>
    <variablelist>
    
      <varlistentry>
      <term>gun: (-sgun:<replaceable>gunname</replaceable>)</term>
      <listitem>
        <para>Data is generated on-the-fly by a named VertexGun. Currently the following named VertexGuns exist: simple, dirty_primary, bjet. This data source is always available.
        </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term>file: (-sfile:<replaceable>filename</replaceable>)</term>
      <listitem>
        <para>Read in from a DataHarvester file. (Obviously, this only exists if support for DataHarvesting has been compiled in). Multiple files can be given with a ";" as a separator.</para>
      </listitem>
      </varlistentry>
      
      <varlistentry>
      <term>lcio: (-slcio:<replaceable>filename:collectionname</replaceable>)</term>
      <listitem>
        <para>Read in from an LCIO file. (Obviously, this only exists if support for LCIO has been compiled in.)</para>
      </listitem>
      </varlistentry>
      
    </variablelist>

</refsect1>

<refsect1 id="Observer">
    <title>OBSERVER</title>
    <para>Depending on the configuration at compile time,
    a certain sub-set of the following &observer; is available to the user:
    </para>
    <variablelist>
    
      <varlistentry>
      <term><ooclass><classname>EventWriter: (-o EventWriter[-filename])</classname></ooclass></term>
      <listitem>
        <para>Simple &observer; that dumps events into a file.
        Depends on DataHarvesting.
        </para>
      </listitem>
      </varlistentry>
      
      <varlistentry>
      <term><ooclass><classname>EventHistogrammer: (-o EventHistogrammer[-filename])</classname></ooclass></term>
      <listitem>
        <para>Writes down some stats about the events.
        Depends on DataHarvesting.
        </para>
      </listitem>
      </varlistentry>
      
      <varlistentry>
      <term><ooclass><classname>EventPrinter:</classname></ooclass></term>
      <listitem>
        <para>Dumps a fancy event description to stdout.
        </para>
      </listitem>
      </varlistentry>
      
      <varlistentry>
      <term><ooclass><classname>FindingObserver: (-o FindingObserver[-filename])</classname></ooclass></term>
      <listitem>
        <para>Special observer for the finding sensitivity paper.
        Depends on DataHarvesting.
        </para>
      </listitem>
      </varlistentry>
      
      <varlistentry>
      <term><ooclass><classname>FitterTournament:</classname></ooclass></term>
      <listitem>
        <para> Tournament observer that compares different fitters.
        Depends on DataHarvesting.
        </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><ooclass><classname>TrackParameterHisto: (-o TrackParameterHisto[-filename])</classname></ooclass></term>
      <listitem>
        <para> Histograms track parameter.
        Depends on DataHarvesting.
        </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><ooclass><classname>VertexHistogrammer: (-o VertexHistogrammer[-filename])</classname></ooclass></term>
      <listitem>
        <para>Analyses the specified fitter.
        Depends on DataHarvesting.
        </para>
      </listitem>
      </varlistentry>

      <varlistentry>
      <term><ooclass><classname>Visualiser:</classname></ooclass></term>
      <listitem>
        <para>&observer; that feeds event to RaveVis. Depends on the Vis package.
        </para>
      </listitem>
      </varlistentry>

    </variablelist>

    <figure id="fig.snapshot">
        <title>A snapshot, created by the Visualiser, one out of a few Observers in vertigo (not visible in the man page).</title>
        <mediaobject>
            <imageobject>
            <imagedata width=400pt align="center" format="PNG" fileref="snapshot.png">
            </imageobject>
            <imageobject>
            <imagedata width=100pt align="center" format="eps" fileref="snapshot.eps">
            </imageobject>
        </mediaobject>
    </figure>

</refsect1>

<refsect1 id="skins">
    <title>SKINS</title>
    <para>Vertigo introduces the skin concept on source code basis for easy prototyping of glue code for various analysis frameworks.
      Skins usually contain parameter transformation routines and implement specific propagators and magnetic fields. They
      hold all detector specific information Rave needs and therefore should be reusable in "general purpose" analysis frameworks
      linking against Rave.
    </para>
    <para>Currently following skins are maintained:</para>
    <variablelist>
      <varlistentry>
      <term>CMSSkin</term>
      <listitem>
      <para> Implements an interface prototype between the CMS framework CMSSW and the Rave library
      </para>
      </listitem></varlistentry>
      <varlistentry>
      <term>LDCSkin</term>
      <listitem><para>
        Contains all necessary code for using Rave within the MarlinReco framework used with the LDC detector.
      </para></listitem>
      </varlistentry>

    </variablelist>
    <para>One can easily specify new skins in a few simple steps:</para>
      <variablelist>
        <varlistentry><term>$ cd vertigo</term>
        <listitem><para></para></listitem>
        </varlistentry>
        <varlistentry><term><command>$ cp -R LDCSkin XYZSkin</command></term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term><command>$ cd XYZSkin</command></term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term><command>$ rename LDC XYZ *</command></term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term><command>$ rename LDC XYZ */*/*</command></term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term><command>$ for fl in */*/*.*; do mv $fl $fl.old; sed 's/LDC/SID/g' $fl.old > $fl; rm -f $fl.old; done</command></term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term>Edit the vertigo/SConstruct file and append the name of the new skin to the line
          <varname>skindirs = [ 'DummySkin', 'CMSSkin', 'LDCSkin', 'SIDSkin' ]</varname> to look like 
          <varname>skindirs = [ 'DummySkin', 'CMSSkin', 'LDCSkin', 'SIDSkin', 'XYZSkin' ]</varname>.
          </term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term>Edit the vertigo/Vertigo/EventLoop/src/EventLoop.cc file and modify the getFactory method. This should be again just some copy'n'paste an renaming. Don't forget to update the includes on top of that file to include your skins' headers.</term>
        <listitem><para></para></listitem>
        </varlistentry><varlistentry><term>Finally append the new skin directory name to the following line in vertigo/Vertigo/SConscript:
          <varname>m.Append( LIBS = [ 'Vertigo', 'CMSSkin', 'DummySkin', 'LDCSkin', 'SIDSkin', 'RaveEnvironment' ] )</varname></term>
        <listitem><para></para></listitem>
        </varlistentry>
      </variablelist>
</refsect1>

</refentry>
